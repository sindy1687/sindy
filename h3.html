<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>æ˜Ÿåº§åœ–é‘‘ - è‹±æ‰“å°è‹±é›„</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet" />
  <style>
    body { margin: 0; font-family: 'Orbitron', sans-serif; background: radial-gradient(circle at top, #000010, #000000); color: #fff; text-align: center; padding: 20px; position: relative; }
    h1 { color: #0ff; text-shadow: 0 0 8px #0ff; margin-bottom: 20px; }
    .tabs { display: flex; justify-content: center; gap: 12px; margin-top: 20px; }
    .tab-btn { padding: 10px 20px; background: #1a1a1a; color: #fff; border: 2px solid #0ff; border-radius: 8px; cursor: pointer; transition: background 0.2s, color 0.2s; }
    .tab-btn.active { background: #0ff; color: #000; }
    .tab-content { display: none; margin-top: 20px; }
    .tab-content.active { display: block; }
    .grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; padding: 20px; max-width: 1000px; margin: 0 auto; justify-items: center; }
    .card { width: 100%; max-width: 140px; height: 220px; background: linear-gradient(145deg, #1a1a1a, #111); border-radius: 12px; padding: 10px; position: relative; box-shadow: 0 0 8px #0ff4, inset 0 0 6px #0ff1; cursor: pointer; display: flex; flex-direction: column; justify-content: center; align-items: center; border: 2px solid transparent; transition: transform 0.2s, box-shadow 0.2s; }
    .card:hover { transform: scale(1.05); box-shadow: 0 0 14px #0ff, inset 0 0 8px #0ff6; }
    .card-title { font-size: 0.9rem; color: #fff; text-align: center; font-weight: bold; text-shadow: 0 0 2px #000; }
    .card-desc { font-size: 0.75rem; color: #ccc; text-align: center; margin-top: 6px; }
    .card-info { font-size: 0.7rem; color: #88f; text-align: center; margin-top: 4px; }
    .card.locked::after { content: attr(data-locktext); position: absolute; top: 36%; left: 50%; transform: translate(-50%, -50%); font-size: 1rem; font-weight: bold; color: #ffff55; text-shadow: 0 0 6px #ff0, 0 0 8px #000; background: rgba(0, 0, 0, 0.7); padding: 4px 8px; border-radius: 6px; z-index: 10; pointer-events: none; animation: glowText 1.5s ease-in-out infinite; }
    @keyframes glowText { 0% { text-shadow: 0 0 6px #ff0, 0 0 8px #000; } 50% { text-shadow: 0 0 12px #ff0, 0 0 16px #000; } 100% { text-shadow: 0 0 6px #ff0, 0 0 8px #000; } }
    .custom-card { border: 2px solid #ff66cc; box-shadow: 0 0 10px #ff99cc; background: #220022; }
    .back-btn { position: absolute; top: 16px; left: 16px; background: #0ff; color: #000; border: none; border-radius: 6px; padding: 6px 12px; font-weight: bold; cursor: pointer; box-shadow: 0 0 6px #0ff; z-index: 2; }
    .back-btn:hover { transform: scale(1.1); box-shadow: 0 0 10px #0ff; }
    #totalStarsDisplay { position: absolute; top: 16px; right: 16px; background: #111; padding: 6px 12px; border-radius: 8px; box-shadow: 0 0 6px #0ff8; font-weight: bold; color: #ffff33; font-size: 1rem; z-index: 2; }
    body, html { touch-action: manipulation; }
    /* Tab2: æ±æ–¹ç¥è©±é‚Šæ¡† */
    #challengeGrid .card { border: 2px solid #ff99cc; box-shadow: 0 0 8px #ff99cc; }
    /* Tab3: å¸Œè‡˜ç¥ç¥‡é‚Šæ¡† */
    #greekGrid .card { border: 2px solid #ffd700; box-shadow: 0 0 8px #ffd700; }
    #greekGrid .card img { width: 80px; height: 80px; border-radius: 50%; object-fit: cover; margin-bottom: 8px; border: 2px solid #ffd700; }
  </style>
</head>
<body>
  <button class="back-btn" onclick="location.href='index.html'">â† è¿”å›é¦–é </button>
  <div id="totalStarsDisplay">â­ ç¸½æ˜Ÿæ•¸ï¼š<span id="displayStars">0</span></div>
  <h1>ğŸŒ  æ˜Ÿåº§åœ–é‘‘ ï¼‹ è‡ªè¨‚æ‹¼å­—é—œå¡</h1>

  <div class="tabs">
    <button class="tab-btn active" data-target="tab1">æ˜Ÿåº§ï¼†å½©è›‹</button>
    <button class="tab-btn" data-target="tab2">æ±æ–¹ç¥è©±</button>
    <button class="tab-btn" data-target="tab3">å¸Œè‡˜ç¥ç¥‡</button>
  </div>

  <div id="tab1" class="tab-content active">
    <h2 style="color:#0ff; text-shadow:0 0 6px #0ff;">æ˜Ÿåº§èˆ‡å½©è›‹é—œå¡</h2>
    <div id="atlasGrid" class="grid" style="border:2px solid #0ff; box-shadow:0 0 10px #0ff; border-radius:12px;"></div>
  </div>

  <div id="tab2" class="tab-content">
    <h2 style="color:#ff99cc; text-shadow:0 0 6px #ff99cc;">æ±æ–¹ç¥è©±æ‹¼å­—é—œå¡</h2>
    <div id="challengeGrid" class="grid" style="border:2px solid #ff99cc; box-shadow:0 0 10px #ff99cc; border-radius:12px;"></div>
  </div>

  <div id="tab3" class="tab-content">
    <h2 style="color:#ffd700; text-shadow:0 0 6px #ffd700;">å¸Œè‡˜ç¥ç¥‡ åé—œå¡</h2>
    <div id="greekGrid" class="grid" style="border:2px solid #ffd700; box-shadow:0 0 10px #ffd700; border-radius:12px;"></div>
  </div>

  <script src="cards.js"></script>
  <script src="js/vocabData.js"></script>
  <script>
    // æ›´æ–°æ˜Ÿæ˜Ÿæ•¸
    let totalStars = parseInt(localStorage.getItem('totalStars') || '0', 10);
    function updateDisplayStars() {
      document.getElementById('displayStars').textContent = totalStars;
      localStorage.setItem('totalStars', totalStars);
    }
    updateDisplayStars();

    // åˆ†é åˆ‡æ›
    const tabBtns = document.querySelectorAll('.tab-btn');
    const tabContents = document.querySelectorAll('.tab-content');
    tabBtns.forEach(btn => btn.addEventListener('click', () => {
      tabBtns.forEach(b => b.classList.remove('active'));
      tabContents.forEach(c => c.classList.remove('active'));
      btn.classList.add('active');
      document.getElementById(btn.dataset.target).classList.add('active');
    }));

    // Tab1: æ˜Ÿåº§ï¼†å½©è›‹
    const atlasContainer = document.getElementById('atlasGrid');
    const atlasCategories = [
      "aries","taurus","gemini","cancer","leo","virgo","libra","scorpio","sagittarius","capricorn",
      "aquarius","pisces","andromeda","cygnus","orion","pegasus","cassiopeia","scorpius","phoenix","vela",
      "custom1","custom2","custom3","custom4"
    ];
    let unlockData = JSON.parse(localStorage.getItem('unlocked') || '[]');
    let costData   = JSON.parse(localStorage.getItem('unlockCosts') || '{}');
    if (!Array.isArray(unlockData) || unlockData.length === 0) {
      const shuffled = atlasCategories.slice().sort(() => 0.5 - Math.random());
      unlockData = shuffled.slice(0, 2);
      localStorage.setItem('unlocked', JSON.stringify(unlockData));
    }
    const unlockCosts = {};
    atlasCategories.forEach(key => {
      unlockCosts[key] = costData.hasOwnProperty(key) ? costData[key] : Math.floor(Math.random()*21)+10;
    });
    atlasCategories.forEach(key => {
      const isCustom = key.startsWith('custom');
      const unlocked = unlockData.includes(key);
      const cost = unlockCosts[key];
      const rarity = (key.startsWith('a')||key.startsWith('o')||key.startsWith('p'))?'epic':(key.length>6?'rare':'common');
      const card = document.createElement('div');
      card.className = `card ${unlocked?'':'locked'} ${rarity} ${isCustom?'custom-card':''}`;
      card.dataset.key = key;
      if (!unlocked) card.dataset.locktext = ` ${cost}â­`;
      const titleText = isCustom?localStorage.getItem(`${key}_name`)||'å½©è›‹é—œå¡':key.toUpperCase();
      const descMap = { aries:'ç‰¡ç¾Šåº§ï¼Œè±¡å¾µå‹‡æ°£èˆ‡å†’éšªã€‚',taurus:'é‡‘ç‰›åº§ï¼Œä»£è¡¨ç©©å®šèˆ‡æ¯…åŠ›ã€‚',gemini:'é›™å­åº§ï¼Œéˆæ´»è°æ˜ï¼Œå–œæ­¡äº¤æµã€‚',cancer:'å·¨èŸ¹åº§ï¼Œæº«æŸ”é«”è²¼ï¼Œå®¶åº­å°å‘ã€‚',leo:'ç…å­åº§ï¼Œé ˜å°åŠ›å¼·ï¼Œå……æ»¿è‡ªä¿¡ã€‚',virgo:'è™•å¥³åº§ï¼Œç´°å¿ƒèªçœŸï¼Œæ³¨é‡ç´°ç¯€ã€‚',libra:'å¤©ç§¤åº§ï¼Œè¿½æ±‚å¹³è¡¡èˆ‡å’Œè«§ã€‚',scorpio:'å¤©è åº§ï¼Œç¥ç¥•å …å®šï¼Œæœ‰æ¯…åŠ›ã€‚',sagittarius:'å°„æ‰‹åº§ï¼Œç†±æ„›è‡ªç”±èˆ‡æ¢ç´¢ã€‚',capricorn:'æ‘©ç¾¯åº§ï¼Œå‹™å¯¦åŠªåŠ›ï¼Œå …æŒåˆ°åº•ã€‚',aquarius:'æ°´ç“¶åº§ï¼Œå‰µæ–°ç¨ç«‹ï¼Œå–œæ­¡æ–°å¥‡ã€‚',pisces:'é›™é­šåº§ï¼Œå¯Œæœ‰æƒ³åƒåŠ›èˆ‡åŒç†å¿ƒã€‚'};
      const descText = isCustom?'è‡ªè¨‚å½©è›‹':(descMap[key]||'');
      card.innerHTML = `<div class="card-title">${titleText}</div><div class="card-desc">${descText}</div><div class="card-info">${unlocked?'å·²è§£é–':`${cost}â­è§£é–`}</div>`;
      card.onclick = () => {
        if (!unlocked) {
          if (totalStars<cost) { alert('æ˜Ÿæ˜Ÿä¸è¶³ï¼Œç„¡æ³•è§£é–æ­¤é—œï¼'); return; }
          if (!confirm(`æ˜¯å¦èŠ±è²» ${cost} é¡†æ˜Ÿæ˜Ÿè§£é–ã€Œ${titleText}ã€ï¼Ÿ`)) return;
          totalStars-=cost; localStorage.setItem('totalStars',totalStars); updateDisplayStars(); unlockData.push(key); localStorage.setItem('unlocked',JSON.stringify(unlockData)); localStorage.setItem('unlockCosts',JSON.stringify(unlockCosts));
        }
        location.href = `quiz.html?category=${encodeURIComponent(key)}&reviewed=1`;
      };
      atlasContainer.appendChild(card);
    });

    // Tab2: æ±æ–¹ç¥è©±
    const challengeContainer = document.getElementById('challengeGrid');
    const bookKeys = Object.keys(localStorage).filter(k=>k.startsWith('book_'));
    let challenge2Costs = JSON.parse(localStorage.getItem('challenge2Costs')||'{}');
    if (!challenge2Costs||!Object.keys(challenge2Costs).length) { bookKeys.forEach(k=>challenge2Costs[k]=Math.floor(Math.random()*21)+10); localStorage.setItem('challenge2Costs',JSON.stringify(challenge2Costs)); }
    let unlockedChallenge2 = JSON.parse(localStorage.getItem('unlockedChallenge2')||'[]');
    function renderChallenge2() {
      challengeContainer.innerHTML = '';
      bookKeys.forEach(bookKey=>{
        const bookName = bookKey.replace('book_',''); const cost=challenge2Costs[bookKey]||10; const isUnlocked=unlockedChallenge2.includes(bookKey);
        const card=document.createElement('div');card.className=`card ${isUnlocked?'':'locked'} custom-card`; if(!isUnlocked)card.dataset.locktext=`${cost}â­è§£é–`;
        card.innerHTML=`<div class="card-title">${bookName}</div><div class="card-info">${isUnlocked?'<span style="color:#0f0">å·²è§£é–</span>':`<span>${cost}â­è§£é–</span>`}</div>`;
        card.onclick=()=>{
          if(isUnlocked) location.href=`spelling.html?book=${encodeURIComponent(bookName)}`;
          else { if(totalStars<cost){alert(`æ˜Ÿæ˜Ÿä¸è¶³ï¼é‚„éœ€è¦ ${cost-totalStars} é¡†æ˜Ÿã€‚`);return;} if(!confirm(`ç¢ºå®šè¦èŠ±è²» ${cost} é¡†â­ è§£é–ã€Œ${bookName}ã€æ±æ–¹ç¥è©±é—œå¡å—ï¼Ÿ`))return; totalStars-=cost; localStorage.setItem('totalStars',totalStars); updateDisplayStars(); unlockedChallenge2.push(bookKey); localStorage.setItem('unlockedChallenge2',JSON.stringify(unlockedChallenge2)); renderChallenge2(); }
        };
        challengeContainer.appendChild(card);
      });
    }
    renderChallenge2();

    // Tab3: å¸Œè‡˜ç¥ç¥‡
    const greekDeities = [
      { id: 'Zeus',       name: 'å®™æ–¯',       img: 'images/zeus.png',       desc: 'çœ¾ç¥ä¹‹ç‹ï¼ŒæŒç®¡å¤©ç©ºèˆ‡é›·é›»ã€‚', link: 'zeus.html' },
      { id: 'Hera',       name: 'èµ«æ‹‰',       img: 'images/hera.png',       desc: 'å©šå§»èˆ‡å®¶åº­ä¹‹å¥³ç¥ï¼Œå®™æ–¯ä¹‹å¦»ã€‚', link: 'hera.html' },
      { id: 'Poseidon',   name: 'æ³¢å¡é “',     img: 'images/poseidon.png',   desc: 'æµ·æ´‹ä¹‹ç¥ï¼ŒæŒæ§é¢¨æš´èˆ‡åœ°éœ‡ã€‚', link: 'poseidon.html' },
      { id: 'Athena',     name: 'é›…å…¸å¨œ',     img: 'images/athena.png',     desc: 'æ™ºæ…§èˆ‡æˆ°ç•¥å¥³ç¥ï¼Œè±¡å¾µç†æ€§èˆ‡è¬€ç•¥ã€‚', link: 'athena.html' },
      { id: 'Apollo',     name: 'é˜¿æ³¢ç¾…',     img: 'images/apollo.png',     desc: 'å…‰æ˜ã€éŸ³æ¨‚èˆ‡é è¨€ä¹‹ç¥ã€‚',           link: 'apollo.html' },
      { id: 'Aphrodite',  name: 'é˜¿èŠ™è˜¿é»›è’‚', img: 'images/aphrodite.png',   desc: 'æ„›èˆ‡ç¾ä¹‹å¥³ç¥ã€‚',              link: 'aphrodite.html' },
      { id: 'Ares',       name: 'é˜¿ç‘æ–¯',     img: 'images/ares.png',       desc: 'æˆ°çˆ­èˆ‡æš´åŠ›ä¹‹ç¥ã€‚',            link: 'ares.html' },
      { id: 'Hades',      name: 'é»‘å¸æ–¯',     img: 'images/hades.png',      desc: 'å†¥ç•Œä¹‹ç‹ï¼ŒæŒç®¡äº¡éˆã€‚',        link: 'hades.html' },
      { id: 'Hephaestus', name: 'èµ«è²æ–¯æ‰˜æ–¯', img: 'images/hephaestus.png', desc: 'ç«èˆ‡é›é€ ä¹‹ç¥ï¼Œçœ¾ç¥åŒ äººã€‚',     link: 'hephaestus.html' },
      { id: 'Hermes',     name: 'èµ«è€³å¢¨æ–¯',   img: 'images/hermes.png',     desc: 'ä¿¡ä½¿ä¹‹ç¥ï¼ŒæŒç®¡æ—…éŠã€è²¿æ˜“èˆ‡å·ç«Šã€‚', link: 'hermes.html' }
    ];
    function renderGreekGodLevels() {
      greekContainer.innerHTML = '';
      greekDeities.forEach(deity => {
        const card = document.createElement('div');
        card.className = 'card custom-card';
        card.innerHTML = `<img src="${deity.img}" alt="${deity.id}" /><div class="card-title">${deity.name}</div><div class="card-desc">${deity.desc}</div>`;
        card.onclick = () => { location.href = deity.link; };
        greekContainer.appendChild(card);
      });
    }
    const greekContainer = document.getElementById('greekGrid');
    renderGreekGodLevels();
  </script>
</body>
</html>
